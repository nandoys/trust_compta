{% extends "partials/base.html" %}
{% load static %}
{% block title %}Revenus{% endblock title %}
{% block extra_css %}
    <!-- Sweet Alert css-->
        <!-- Dragula css -->
    <link rel="stylesheet" href="{% static 'libs/dragula/dist/dragula.min.css' %}" />
    <link href="{% static 'libs/sweetalert2/dist/sweetalert2.min.css' %}" rel="stylesheet" type="text/css" />

{% endblock extra_css %}

{% block content %}

        <v-app id="app" >
            {% block header %}
                 {% include "partials/topbar.html" %}
            {% endblock header %}
            <v-navigation-drawer app absolute clipped src="{% static 'images/cover-pattern.png' %}">
              <v-list-item>
                <v-list-item-content>
                  <v-list-item-title class="text-h6">
                    Module
                  </v-list-item-title>
                  <v-list-item-subtitle>
                    Trésorerie
                  </v-list-item-subtitle>
                </v-list-item-content>
              </v-list-item>

              <v-divider></v-divider>

                <v-list-item-group
                  v-model="selectedModule"
                  color="primary"
                >
                  <v-list-item v-for="(item, i) in items" :key="i">
                      <v-list-item-icon>
                        <v-icon v-text="item.icon"></v-icon>
                      </v-list-item-icon>
                      <v-list-item-content>
                          <v-list-item-title v-text="item.text"></v-list-item-title>
                      </v-list-item-content>
                  </v-list-item>
                </v-list-item-group>
            </v-navigation-drawer>
            <v-main>
                <v-sheet
                  id="scrolling-techniques"
                  class="overflow-y-auto"
                  max-height="600"
                >
                    <v-container>
                    <!-- end page title -->

                         <v-tabs v-model="tab">
                                <v-tabs-slider></v-tabs-slider>
                                <v-tab key="incomes">
                                    Opération d'entrée
                                </v-tab>
                                <v-tab key="outcomes">
                                     Opération de sortie
                                </v-tab>
                         </v-tabs>

                        <v-tabs-items v-model="tab">
                            <!-- tab of incomes -->
                            <v-tab-item key="incomes">
                                <v-row>
                                    <v-col cols="4" class="pa-1">
                                        <v-card>
                                            <v-card-title>Balance de la Caisse</v-card-title>
                                        </v-card>
                                    </v-col>
                                    <v-col cols="4" class="pa-1">
                                        <v-card>
                                            <v-card-title>Balance du mois</v-card-title>
                                        </v-card>
                                    </v-col>
                                    <v-col cols="4" class="pa-1">
                                        <v-card>
                                            <v-card-title>Balance du jour</v-card-title>
                                        </v-card>
                                    </v-col>
                                </v-row>
                                <v-row class="d-flex p-4">
                                     <v-data-table
                                        :headers="headers"
                                        :loading="loadingIncomes"
                                        loading-text="Chargemnt... Veuillez attendre"
                                        :items="incomes"
                                        :items-per-page="10"
                                        :search="searchIncomes"
                                        class="elevation-1"
                                        locale="fr-FR"
                                        no-data-text="Vous n'avez aucun compte dans votre plan"
                                        no-results-text="Aucun résultat n'a été trouvé pour votre recherche"
                                        :footer-props="{
                                            itemsPerPageText: 'Affichage par page'
                                        }"
                                    >

                                        <template v-slot:top>
                                            <v-toolbar flat>
                                                <v-toolbar-title>${ capFirst(moduleName) } en {{ currency.name }}</v-toolbar-title>

                                                <v-divider
                                                  class="mx-4"
                                                  inset
                                                  vertical
                                                ></v-divider>
                                                <v-text-field
                                                    v-model="searchIncomes"
                                                    append-icon="mdi-magnify"
                                                    label="Recherche"
                                                    single-line
                                                    hide-details
                                                ></v-text-field>
                                                <v-spacer></v-spacer>

                                                <v-dialog v-model="dialogEntry" max-width="900px" persistent>
                                                    <template v-slot:activator="{ on, attrs }">
                                                        <v-btn
                                                          color="primary"
                                                          dark
                                                          class="mb-2"
                                                          v-bind="attrs"
                                                          v-on="on"
                                                          small
                                                        >
                                                          Passer écriture
                                                        </v-btn>
                                                    </template>
                                                    <v-card>
                                                        <v-card-title>
                                                          <span class="text-h5">Écriture comptable</span>
                                                        </v-card-title>
                                                        <v-card-text>
                                                            <v-container>
                                                                 <v-form
                                                                   ref="formIncome"
                                                                   lazy-validation
                                                                >
                                                                    <v-row>
                                                                        <v-col cols="12">
                                                                            <!-- Datefield, slip field and label field  -->
                                                                            <v-row>
                                                                                 <v-col cols="4">
                                                                                    <v-menu
                                                                                        ref="datemenuIncomes"
                                                                                        v-model="menuIncomes"
                                                                                        :close-on-content-click="false"
                                                                                        :nudge-right="40"
                                                                                        transition="scale-transition"
                                                                                        offset-y
                                                                                        min-width="auto"
                                                                                    >
                                                                                        <template v-slot:activator="{ on, attrs }">
                                                                                            <v-text-field
                                                                                                v-model="computedDateIncomesFormatted"
                                                                                                :rules="rules.date"
                                                                                                label="Date de l'opération"
                                                                                                readonly
                                                                                                v-bind="attrs"
                                                                                                v-on="on"
                                                                                                dense
                                                                                            ></v-text-field>
                                                                                        </template>
                                                                                        <v-date-picker
                                                                                            v-model="editedItemIncome.dateOperation"
                                                                                            no-title
                                                                                            @input="menuIncomes = false"
                                                                                            first-day-of-week="1"
                                                                                            :min="minDate"
                                                                                            :max="maxDate"
                                                                                            locale="fr-fr"
                                                                                            :show-current="editedItemIncome.dateOperation"
                                                                                        ></v-date-picker>
                                                                                    </v-menu>
                                                                                </v-col>
                                                                                <v-col cols="4" ref="slip">
                                                                                     <v-select
                                                                                      v-model="editedItemIncome.slip"
                                                                                      hide-selected="true"
                                                                                      :rules="rules.slip"
                                                                                      :items="typeDocuments"
                                                                                      item-text="label"
                                                                                      item-value="id"
                                                                                      :loading="typeDocumentLoading"
                                                                                      label="Pièce comptable"
                                                                                      no-data-text="Aucun type de pièce comptable n'a été trouvé"
                                                                                      dense
                                                                                    >
                                                                                        <template v-slot:prepend-item>
                                                                                            <v-list-item>
                                                                                                <v-list-item-content>
                                                                                                    <v-text-field v-model="searchIncomesSlip" :autofocus="false" placeholder="Recherche type de pièce" @input="searchIncomestypeDocuments">
                                                                                                    </v-text-field>
                                                                                                </v-list-item-content>
                                                                                            </v-list-item>
                                                                                        </template>
                                                                                    </v-select>
                                                                                </v-col>
                                                                                <v-col cols="4" ref="slipNumber">
                                                                                    <v-text-field
                                                                                        v-model="editedItemIncome.slipNumber"
                                                                                        :rules="rules.slipNumber"
                                                                                        label="Numéro de la pièce"
                                                                                        dense
                                                                                    ></v-text-field>
                                                                                </v-col>
                                                                                <v-col cols="4" ref="label">
                                                                                    <v-text-field
                                                                                        v-model="editedItemIncome.label"
                                                                                        :rules="rules.label"
                                                                                        label="Libellé"
                                                                                        dense
                                                                                    ></v-text-field>
                                                                                </v-col>
                                                                                <v-col cols="4" ref="currency">
                                                                                    <v-select
                                                                                      v-model="editedItemIncome.currency"
                                                                                      hide-selected="true"
                                                                                      :rules="rules.currency"
                                                                                      :items="currenciesIncomes"
                                                                                      item-text="label"
                                                                                      item-value="id"
                                                                                      :loading="currencyOperationIncomeLoading"
                                                                                      label="Devise de l'opération"
                                                                                      no-data-text="Aucune devise n'a été trouvée"
                                                                                      dense
                                                                                    >
                                                                                        <template v-slot:prepend-item>
                                                                                            <v-list-item>
                                                                                                <v-list-item-content>
                                                                                                    <v-text-field v-model="searchIncomesDebit" :autofocus="false" placeholder="Recherche compte" @input="searchIncomesDebitAccounts">
                                                                                                    </v-text-field>
                                                                                                </v-list-item-content>
                                                                                            </v-list-item>
                                                                                        </template>
                                                                                    </v-select>
                                                                                </v-col>
                                                                                <v-col cols="4" ref="dailyRate" v-if="isForeigncurrencyOperationIncome">
                                                                                    <v-text-field
                                                                                        v-model="editedItemIncome.rate"
                                                                                        :rules="rules.rate"
                                                                                        label="Taux de change"
                                                                                        dense
                                                                                    ></v-text-field>
                                                                                </v-col>
                                                                            </v-row>
                                                                            <!-- Debit field and Credit field -->
                                                                            <v-row>
                                                                                <!-- Debit fields -->
                                                                                <v-col cols="6">
                                                                                    <v-row v-for="count in countDebitAccountIncome">
                                                                                        <v-col cols="6">
                                                                                            <v-select
                                                                                              v-model="editedItemIncome.debitAccount[count-1]"
                                                                                              hide-selected="true"
                                                                                              :rules="rules.account"
                                                                                              :items="debitAccountsIncomes"
                                                                                              item-text="label"
                                                                                              item-value="id"
                                                                                              :loading="debitIncomesLoading"
                                                                                              label="Compte à débiter"
                                                                                              no-data-text="Aucun compte n'a été trouvé"
                                                                                              dense
                                                                                            >
                                                                                                <template v-slot:prepend-item>
                                                                                                    <v-list-item>
                                                                                                        <v-list-item-content>
                                                                                                            <v-text-field v-model="searchIncomesDebit" :autofocus="false" placeholder="Recherche compte" @input="searchIncomesDebitAccounts">
                                                                                                            </v-text-field>
                                                                                                        </v-list-item-content>
                                                                                                    </v-list-item>
                                                                                                </template>
                                                                                            </v-select>
                                                                                        </v-col>
                                                                                        <v-col cols="6">
                                                                                            <v-text-field
                                                                                                v-if="countDebitAccountIncome > 1"
                                                                                                v-model="editedItemIncome.amountDebit[count-1]"
                                                                                                :rules="rules.amount"
                                                                                                :label="symbolCurrency"
                                                                                                dense
                                                                                            >
                                                                                                <template v-slot:append-outer="">
                                                                                                    <v-tooltip bottom>
                                                                                                        <template v-slot:activator="{ on, attrs }">
                                                                                                            <v-btn icon color="primary" small v-bind="attrs" v-on="on"
                                                                                                              @click="decrementCountDebitAccountIncome(count)"
                                                                                                            >
                                                                                                              <v-icon>mdi-close</v-icon>
                                                                                                            </v-btn>
                                                                                                        </template>
                                                                                                        <span>Retirer</span>
                                                                                                    </v-tooltip>
                                                                                                </template>
                                                                                            </v-text-field>
                                                                                            <v-text-field
                                                                                                v-else
                                                                                                v-model="editedItemIncome.amountDebit[count-1]"
                                                                                                :rules="rules.amount"
                                                                                                :label="symbolCurrency"
                                                                                                dense
                                                                                            ></v-text-field>
                                                                                        </v-col>
                                                                                    </v-row>
                                                                                </v-col>
                                                                                <!-- Credit fields -->
                                                                                <v-col cols="6">
                                                                                    <v-row v-for="count in countCreditAccountIncome">
                                                                                        <v-col cols="6">
                                                                                            <v-select
                                                                                              v-model="editedItemIncome.creditAccount[count-1]"
                                                                                              hide-selected="true"
                                                                                              :rules="rules.account"
                                                                                              :items="creditAccountsIncomes"
                                                                                              item-text="label"
                                                                                              item-value="id"
                                                                                              :loading="creditIncomesLoading"
                                                                                              label="Compte à créditer"
                                                                                              no-data-text="Aucun compte n'a été trouvé"
                                                                                              dense
                                                                                            >
                                                                                                <template v-slot:prepend-item>
                                                                                                    <v-list-item>
                                                                                                        <v-list-item-content>
                                                                                                            <v-text-field v-model="searchIncomesCredit" :autofocus="false" placeholder="Recherche compte" @input="searchIncomesCreditAccounts">
                                                                                                            </v-text-field>
                                                                                                        </v-list-item-content>
                                                                                                    </v-list-item>
                                                                                                </template>
                                                                                            </v-select>
                                                                                        </v-col>
                                                                                        <v-col cols="6">
                                                                                             <v-text-field
                                                                                                v-if="countCreditAccountIncome > 1"
                                                                                                v-model="editedItemIncome.amountCredit[count-1]"
                                                                                                :rules="rules.amount"
                                                                                                :label="symbolCurrency"
                                                                                                dense
                                                                                            >
                                                                                                <template v-slot:append-outer="">
                                                                                                    <v-tooltip bottom>
                                                                                                        <template v-slot:activator="{ on, attrs }">
                                                                                                            <v-btn icon color="primary" small v-bind="attrs" v-on="on"
                                                                                                              @click="decrementCountCreditAccountIncome(count)"
                                                                                                            >
                                                                                                              <v-icon>mdi-close</v-icon>
                                                                                                            </v-btn>
                                                                                                        </template>
                                                                                                        <span>Retirer</span>
                                                                                                    </v-tooltip>
                                                                                                </template>
                                                                                            </v-text-field>
                                                                                            <v-text-field
                                                                                                v-else
                                                                                                v-model="editedItemIncome.amountCredit[count-1]"
                                                                                                :rules="rules.amount"
                                                                                                :label="symbolCurrency"
                                                                                                dense
                                                                                            ></v-text-field>
                                                                                        </v-col>
                                                                                    </v-row>
                                                                                    <v-row class="d-flex justify-center">
                                                                                        <v-tooltip bottom>
                                                                                            <template v-slot:activator="{ on, attrs }">
                                                                                                <v-btn icon color="primary" small v-bind="attrs" v-on="on"
                                                                                                  @click="incrementCountCreditAccountIncome" text>
                                                                                                  Ajouter
                                                                                                </v-btn>
                                                                                            </template>
                                                                                            <span>compte à créditer</span>
                                                                                        </v-tooltip>
                                                                                    </v-row>
                                                                                </v-col>
                                                                            </v-row>
                                                                        </v-col>
                                                                    </v-row>
                                                                </v-form>
                                                            </v-container>
                                                        </v-card-text>
                                                        <v-card-actions>
                                                            <v-spacer></v-spacer>
                                                            <v-btn text @click="closeDialogEntry">Annuler</v-btn>
                                                            <v-btn text @click="saveAndClose">Enregistrer & Quitter</v-btn>
                                                            <v-btn text @click="saveAndContinue">Enregistrer & Continuer</v-btn>
                                                        </v-card-actions>
                                                    </v-card>
                                                </v-dialog>

                                                <div class="mx-2"></div>

                                                <v-dialog v-model="dialogInternTrans" max-width="900px">
                                                    <template v-slot:activator="{ on, attrs }">
                                                        <v-btn
                                                          color="primary"
                                                          dark
                                                          class="mb-2"
                                                          v-bind="attrs"
                                                          v-on="on"
                                                          small
                                                        >
                                                          Transaction interne
                                                        </v-btn>
                                                    </template>
                                                    <v-card>
                                                        <v-card-title>
                                                          <span class="text-h5">Écriture comptable</span>
                                                        </v-card-title>
                                                        <v-card-text>
                                                            <v-container>
                                                                 <v-form
                                                                   ref="formIncome"
                                                                   lazy-validation
                                                                >
                                                                    <v-row>
                                                                        <v-col cols="12">
                                                                            <!-- Datefield, slip field and label field  -->
                                                                            <v-row>
                                                                                 <v-col cols="4">
                                                                                    <v-menu
                                                                                        ref="datemenuIncomes"
                                                                                        v-model="menuIncomes"
                                                                                        :close-on-content-click="false"
                                                                                        :nudge-right="40"
                                                                                        transition="scale-transition"
                                                                                        offset-y
                                                                                        min-width="auto"
                                                                                    >
                                                                                        <template v-slot:activator="{ on, attrs }">
                                                                                            <v-text-field
                                                                                                v-model="computedDateIncomesFormatted"
                                                                                                :rules="rules.date"
                                                                                                label="Date de l'opération"
                                                                                                readonly
                                                                                                v-bind="attrs"
                                                                                                v-on="on"
                                                                                                dense
                                                                                            ></v-text-field>
                                                                                        </template>
                                                                                        <v-date-picker
                                                                                            v-model="editedItemIncome.dateOperation"
                                                                                            no-title
                                                                                            @input="menuIncomes = false"
                                                                                            first-day-of-week="1"
                                                                                            :min="minDate"
                                                                                            :max="maxDate"
                                                                                            locale="fr-fr"
                                                                                            :show-current="editedItemIncome.dateOperation"
                                                                                        ></v-date-picker>
                                                                                    </v-menu>
                                                                                </v-col>
                                                                                <v-col cols="4">
                                                                                    <v-text-field
                                                                                        v-model="editedItemIncome.slip"
                                                                                        :rules="rules.slipNumber"
                                                                                        label="Numéro bordereau"
                                                                                        dense
                                                                                    ></v-text-field>
                                                                                </v-col>
                                                                                <v-col cols="4">
                                                                                    <v-text-field
                                                                                        v-model="editedItemIncome.label"
                                                                                        :rules="rules.amount"
                                                                                        label="Libellé"
                                                                                        dense
                                                                                    ></v-text-field>
                                                                                </v-col>
                                                                            </v-row>
                                                                            <!-- Debit field and Credit field -->
                                                                            <v-row>
                                                                                <!-- Debit fields -->
                                                                                <v-col cols="6">
                                                                                    <v-row v-for="count in countDebitAccountIncome">
                                                                                        <v-col cols="6">
                                                                                            <v-select
                                                                                              v-model="editedItemIncome.debitAccount[count-1]"
                                                                                              hide-selected="true"
                                                                                              :rules="rules.account"
                                                                                              :items="debitAccountsIncomes"
                                                                                              item-text="label"
                                                                                              item-value="id"
                                                                                              :loading="debitIncomesLoading"
                                                                                              label="Compte à débiter"
                                                                                              no-data-text="Aucun compte n'a été trouvé"
                                                                                              dense
                                                                                            >
                                                                                                <template v-slot:prepend-item>
                                                                                                    <v-list-item>
                                                                                                        <v-list-item-content>
                                                                                                            <v-text-field v-model="searchIncomesDebit" :autofocus="false" placeholder="Recherche compte" @input="searchIncomesDebitAccounts">
                                                                                                            </v-text-field>
                                                                                                        </v-list-item-content>
                                                                                                    </v-list-item>
                                                                                                </template>
                                                                                            </v-select>
                                                                                        </v-col>
                                                                                        <v-col cols="6">
                                                                                            <v-text-field
                                                                                                v-if="countDebitAccountIncome > 1"
                                                                                                v-model="editedItemIncome.amountDebit[count-1]"
                                                                                                :rules="rules.amount"
                                                                                                label="Montant en {{ currency.symbol|upper }}"
                                                                                                dense
                                                                                            >
                                                                                                <template v-slot:append-outer="">
                                                                                                    <v-tooltip bottom>
                                                                                                        <template v-slot:activator="{ on, attrs }">
                                                                                                            <v-btn icon color="primary" small v-bind="attrs" v-on="on"
                                                                                                              @click="decrementCountDebitAccountIncome(count)"
                                                                                                            >
                                                                                                              <v-icon>mdi-close</v-icon>
                                                                                                            </v-btn>
                                                                                                        </template>
                                                                                                        <span>Retirer</span>
                                                                                                    </v-tooltip>
                                                                                                </template>
                                                                                            </v-text-field>
                                                                                            <v-text-field
                                                                                                v-else
                                                                                                v-model="editedItemIncome.amountDebit[count-1]"
                                                                                                :rules="rules.amount"
                                                                                                label="Montant en {{ currency.symbol|upper }}"
                                                                                                dense
                                                                                            ></v-text-field>
                                                                                        </v-col>
                                                                                    </v-row>
                                                                                    <v-row class="d-flex justify-center">
                                                                                        <v-tooltip bottom>
                                                                                            <template v-slot:activator="{ on, attrs }">
                                                                                                <v-btn icon color="primary" small v-bind="attrs" v-on="on"
                                                                                                  @click="incrementCountDebitAccountIncome" text
                                                                                                >
                                                                                                  Ajouter
                                                                                                </v-btn>
                                                                                            </template>
                                                                                            <span>compte à débiter</span>
                                                                                        </v-tooltip>
                                                                                    </v-row>
                                                                                </v-col>
                                                                                <!-- Credit fields -->
                                                                                <v-col cols="6">
                                                                                    <v-row v-for="count in countCreditAccountIncome">
                                                                                        <v-col cols="6">
                                                                                            <v-select
                                                                                              v-model="editedItemIncome.creditAccount[count-1]"
                                                                                              hide-selected="true"
                                                                                              :rules="rules.account"
                                                                                              :items="creditAccountsIncomes"
                                                                                              item-text="label"
                                                                                              item-value="id"
                                                                                              :loading="creditIncomesLoading"
                                                                                              label="Compte à créditer"
                                                                                              no-data-text="Aucun compte n'a été trouvé"
                                                                                              dense
                                                                                            >
                                                                                                <template v-slot:prepend-item>
                                                                                                    <v-list-item>
                                                                                                        <v-list-item-content>
                                                                                                            <v-text-field v-model="searchIncomesCredit" :autofocus="false" placeholder="Recherche compte" @input="searchIncomesCreditAccounts">
                                                                                                            </v-text-field>
                                                                                                        </v-list-item-content>
                                                                                                    </v-list-item>
                                                                                                </template>
                                                                                            </v-select>
                                                                                        </v-col>
                                                                                        <v-col cols="6">
                                                                                             <v-text-field
                                                                                                v-if="countCreditAccountIncome > 1"
                                                                                                v-model="editedItemIncome.amountCredit[count-1]"
                                                                                                :rules="rules.amount"
                                                                                                label="Montant en {{ currency.symbol|upper }}"
                                                                                                dense
                                                                                            >
                                                                                                <template v-slot:append-outer="">
                                                                                                    <v-tooltip bottom>
                                                                                                        <template v-slot:activator="{ on, attrs }">
                                                                                                            <v-btn icon color="primary" small v-bind="attrs" v-on="on"
                                                                                                              @click="decrementCountCreditAccountIncome(count)"
                                                                                                            >
                                                                                                              <v-icon>mdi-close</v-icon>
                                                                                                            </v-btn>
                                                                                                        </template>
                                                                                                        <span>Retirer</span>
                                                                                                    </v-tooltip>
                                                                                                </template>
                                                                                            </v-text-field>
                                                                                            <v-text-field
                                                                                                v-else
                                                                                                v-model="editedItemIncome.amountCredit[count-1]"
                                                                                                :rules="rules.amount"
                                                                                                label="Montant en {{ currency.symbol|upper }}"
                                                                                                dense
                                                                                            ></v-text-field>
                                                                                        </v-col>
                                                                                    </v-row>
                                                                                    <v-row class="d-flex justify-center">
                                                                                        <v-tooltip bottom>
                                                                                            <template v-slot:activator="{ on, attrs }">
                                                                                                <v-btn icon color="primary" small v-bind="attrs" v-on="on"
                                                                                                  @click="incrementCountCreditAccountIncome" text>
                                                                                                  Ajouter
                                                                                                </v-btn>
                                                                                            </template>
                                                                                            <span>compte à créditer</span>
                                                                                        </v-tooltip>
                                                                                    </v-row>
                                                                                </v-col>
                                                                            </v-row>
                                                                        </v-col>
                                                                    </v-row>
                                                                </v-form>
                                                            </v-container>
                                                        </v-card-text>
                                                        <v-card-actions>
                                                            <v-spacer></v-spacer>
                                                            <v-btn text>Annuler</v-btn>
                                                            <v-btn text>Enregistrer</v-btn>
                                                        </v-card-actions>
                                                    </v-card>
                                                </v-dialog>

                                                <v-dialog v-model="dialogIncomes" persistent max-width="600px" fullscreen>
                                                    <v-card>
                                                        <v-card-title>
                                                          <span class="text-h5">${ formTitle }</span>
                                                        </v-card-title>
                                                        <v-card-text>
                                                            <v-container>
                                                                <v-row>
                                                                  <v-col cols="12" sm="12" md="12">
                                                                    <v-text-field
                                                                        v-model="editedItemIncome.dateOperation"
                                                                        outlined
                                                                        label="Date de l'opération"
                                                                        dense
                                                                    ></v-text-field>
                                                                  </v-col>
                                                                  <v-col cols="12" sm="12" md="12">
                                                                    <v-text-field
                                                                        v-model="editedItemIncome.accountname"
                                                                        outlined
                                                                        label="Intitulé de compte"
                                                                        dense
                                                                    ></v-text-field>
                                                                  </v-col>
                                                                  <v-col cols="12" sm="12" md="12">
                                                                    <v-text-field
                                                                        v-model="editedItemIncome.accountslip"
                                                                        outlined
                                                                        label="Numéro bordereau"
                                                                        dense
                                                                    ></v-text-field>
                                                                  </v-col>
                                                                  <v-col cols="12" sm="12" md="12">
                                                                    <v-text-field
                                                                        v-model="editedItemIncome.detail"
                                                                        outlined
                                                                        label="Détail"
                                                                        dense
                                                                    ></v-text-field>
                                                                  </v-col>
                                                                  <v-col cols="12" sm="12" md="12">
                                                                    <v-text-field
                                                                        v-model="editedItemIncome.amount"
                                                                        outlined
                                                                        label="Montant"
                                                                        dense
                                                                    ></v-text-field>
                                                                  </v-col>
                                                                </v-row>
                                                            </v-container>
                                                        </v-card-text>
                                                        <v-card-actions>
                                                          <v-spacer></v-spacer>
                                                          <v-btn
                                                            color="blue darken-1"
                                                            text
                                                            @click="dialogIncomes = false"
                                                          >
                                                            Fermer
                                                          </v-btn>
                                                          <v-btn
                                                            color="blue darken-1"
                                                            text
                                                            @click=""
                                                          >
                                                            Enregistrer
                                                          </v-btn>
                                                        </v-card-actions>
                                                    </v-card>
                                                </v-dialog>
                                                <v-dialog v-model="dialogIncomesDelete" max-width="500px">
                                                  <v-card>
                                                    <v-card-title class="text-h5">Avertissement!</v-card-title>
                                                    <v-card-text>Êtes-vous sûr de vouloir supprimer ce compte?
                                                        Toutes les opérations associées avec ce compte seront également supprimées et ne pourront plus être récupérées.</v-card-text>
                                                    <v-card-actions>
                                                      <v-spacer></v-spacer>
                                                      <v-btn color="blue darken-1" text @click="closeDelete">Annuller</v-btn>
                                                      <v-btn color="red darken-1" text @click="deleteItemConfirm">OK</v-btn>
                                                      <v-spacer></v-spacer>
                                                    </v-card-actions>
                                                  </v-card>
                                                </v-dialog>
                                            </v-toolbar>
                                        </template>
                                        <template v-slot:item.actions="{ item }">
                                            <v-icon
                                                small
                                                class="mr-2"
                                                @click="editItem(item)"
                                            >
                                                mdi-pencil
                                            </v-icon>
                                            <v-icon
                                                small
                                                @click="deleteItem(item)"
                                            >
                                                mdi-delete
                                            </v-icon>
                                        </template>
                                    </v-data-table>
                                </v-row>
                            </v-tab-item>

                            <!-- tab of outcomes -->
                            <v-tab-item key="outcomes">
                            <v-row class="d-flex p-4">
                                <v-col cols="3">
                                    <v-card>
                                        <v-card-text>
                                            <v-form
                                               ref="form"
                                               lazy-validation
                                            >
                                                <v-roW>
                                                    <v-col cols="12" sm="12" md="12">
                                                        <v-card-title class="text-h5 font-weight-medium">Écriture comptable</v-card-title>
                                                    </v-col>
                                                    <v-col cols="12">
                                                        <v-row>
                                                            <v-col cols="12">
                                                                <v-select
                                                                  v-model="editedItemOutcome.creditAccount"
                                                                  :rules="rules.account"
                                                                  :items="creditAccountsOutcomes"
                                                                  item-text="label"
                                                                  item-value="id"
                                                                  :loading="creditOutcomesLoading"
                                                                  label="Compte à créditer"
                                                                  no-data-text="Aucun compte n'a été trouvé"
                                                                  dense
                                                                >
                                                                    <template v-slot:prepend-item>
                                                                        <v-list-item>
                                                                            <v-list-item-content>
                                                                                <v-text-field v-model="searchOutcomesCredit" :autofocus="false" placeholder="Recherche compte" @input="searchOutcomesCreditAccounts">
                                                                                </v-text-field>
                                                                            </v-list-item-content>
                                                                        </v-list-item>
                                                                    </template>
                                                                </v-select>
                                                            </v-col>
                                                            <v-col cols="12">
                                                                <v-select
                                                                  v-model="editedItemOutcome.debitAccount"
                                                                  :rules="rules.account"
                                                                  :items="debitAccountsOutcomes"
                                                                  item-text="label"
                                                                  item-value="id"
                                                                  :loading="debitOutcomesLoading"
                                                                  label="Compte à débiter"
                                                                  no-data-text="Aucun compte n'a été trouvé"
                                                                  dense
                                                                >
                                                                    <template v-slot:prepend-item>
                                                                        <v-list-item>
                                                                            <v-list-item-content>
                                                                                <v-text-field v-model="searchOutcomesDebit" :autofocus="false" placeholder="Recherche compte" @input="searchOutcomesDebitAccounts">
                                                                                </v-text-field>
                                                                            </v-list-item-content>
                                                                        </v-list-item>
                                                                    </template>
                                                                </v-select>
                                                            </v-col>
                                                             <v-col cols="12">
                                                                <v-menu
                                                                    ref="datemenuOutcomes"
                                                                    v-model="menuOutcomes"
                                                                    :close-on-content-click="false"
                                                                    :nudge-right="40"
                                                                    transition="scale-transition"
                                                                    offset-y
                                                                    min-width="auto"
                                                                >
                                                                    <template v-slot:activator="{ on, attrs }">
                                                                        <v-text-field
                                                                            v-model="computedDateOutcomesFormatted"
                                                                            :rules="rules.date"
                                                                            label="Date de l'opération"
                                                                            readonly
                                                                            v-bind="attrs"
                                                                            v-on="on"
                                                                            dense
                                                                        ></v-text-field>
                                                                    </template>
                                                                    <v-date-picker
                                                                        v-model="editedItemOutcome.dateOperation"
                                                                        no-title
                                                                        @input="menuOutcomes = false"
                                                                        first-day-of-week="1"
                                                                        :min="minDate"
                                                                        :max="maxDate"
                                                                        locale="fr-fr"
                                                                        :show-current="editedItemOutcome.dateOperation"
                                                                    ></v-date-picker>
                                                                </v-menu>
                                                            </v-col>
                                                            <v-col cols="12">
                                                                <v-text-field
                                                                    v-model="editedItemOutcome.slip"
                                                                    :rules="rules.slipNumber"
                                                                    label="Numéro bordereau"
                                                                    dense
                                                                ></v-text-field>
                                                            </v-col>
                                                            <v-col cols="12">
                                                                <v-text-field
                                                                    v-model="editedItemOutcome.amount"
                                                                    :rules="rules.amount"
                                                                    label="Montant en {{ currency.symbol|upper }}"
                                                                    dense
                                                                ></v-text-field>
                                                            </v-col>
                                                        </v-row>
                                                    </v-col>
                                                    <v-col cols="12" sm="12" md="12">
                                                        <v-btn
                                                          color="blue darken-3"
                                                          class="white--text"
                                                          @click=""
                                                          small
                                                        >
                                                          Ajouter
                                                        </v-btn>
                                                    </v-col>
                                                </v-roW>
                                            </v-form>
                                        </v-card-text>
                                    </v-card>
                                </v-col>
                                <v-col cols="9">
                                     <v-data-table
                                        :headers="headers"
                                        :loading="loadingOutcomes"
                                        loading-text="Chargemnt... Veuillez attendre"
                                        :items="outcomes"
                                        :items-per-page="10"
                                        :search="searchOutcomes"
                                        class="elevation-1"
                                        locale="fr-FR"
                                        no-data-text="Vous n'avez aucun compte dans votre plan"
                                        no-results-text="Aucun résultat n'a été trouvé pour votre recherche"
                                        :footer-props="{
                                            itemsPerPageText: 'Affichage par page'
                                        }"
                                    >
                                        <template v-slot:top>
                                            <v-toolbar flat>
                                                <v-toolbar-title>${ capFirst(moduleName) } en {{ currency.name }}</v-toolbar-title>

                                                <v-divider
                                                  class="mx-4"
                                                  inset
                                                  vertical
                                                ></v-divider>

                                                <v-text-field
                                                    v-model="searchOutcomes"
                                                    append-icon="mdi-magnify"
                                                    label="Recherche"
                                                    single-line
                                                    hide-details
                                                ></v-text-field>
                                                <v-spacer></v-spacer>

                                                <v-dialog v-model="dialogOutcomes" persistent max-width="600px" fullscreen>
                                                    <v-card>
                                                        <v-card-title>
                                                          <span class="text-h5">${ formTitle }</span>
                                                        </v-card-title>
                                                        <v-card-text>
                                                            <v-container>
                                                                <v-row>
                                                                  <v-col cols="12" sm="12" md="12">
                                                                    <v-text-field
                                                                        v-model="editedItemIncome.dateOperation"
                                                                        outlined
                                                                        label="Date de l'opération"
                                                                        dense
                                                                    ></v-text-field>
                                                                  </v-col>
                                                                  <v-col cols="12" sm="12" md="12">
                                                                    <v-text-field
                                                                        v-model="editedItemIncome.accountname"
                                                                        outlined
                                                                        label="Intitulé de compte"
                                                                        dense
                                                                    ></v-text-field>
                                                                  </v-col>
                                                                  <v-col cols="12" sm="12" md="12">
                                                                    <v-text-field
                                                                        v-model="editedItemIncome.accountslip"
                                                                        outlined
                                                                        label="Numéro bordereau"
                                                                        dense
                                                                    ></v-text-field>
                                                                  </v-col>
                                                                  <v-col cols="12" sm="12" md="12">
                                                                    <v-text-field
                                                                        v-model="editedItemIncome.detail"
                                                                        outlined
                                                                        label="Détail"
                                                                        dense
                                                                    ></v-text-field>
                                                                  </v-col>
                                                                  <v-col cols="12" sm="12" md="12">
                                                                    <v-text-field
                                                                        v-model="editedItemIncome.amount"
                                                                        outlined
                                                                        label="Montant"
                                                                        dense
                                                                    ></v-text-field>
                                                                  </v-col>
                                                                </v-row>
                                                            </v-container>
                                                        </v-card-text>
                                                        <v-card-actions>
                                                          <v-spacer></v-spacer>
                                                          <v-btn
                                                            color="blue darken-1"
                                                            text
                                                            @click="dialogOutcomes = false"
                                                          >
                                                            Fermer
                                                          </v-btn>
                                                          <v-btn
                                                            color="blue darken-1"
                                                            text
                                                            @click=""
                                                          >
                                                            Enregistrer
                                                          </v-btn>
                                                        </v-card-actions>
                                                    </v-card>
                                                </v-dialog>
                                                <v-dialog v-model="dialogOutcomesDelete" max-width="500px">
                                                  <v-card>
                                                    <v-card-title class="text-h5">Avertissement!</v-card-title>
                                                    <v-card-text>Êtes-vous sûr de vouloir supprimer ce compte?
                                                        Toutes les opérations associées avec ce compte seront également supprimées et ne pourront plus être récupérées.</v-card-text>
                                                    <v-card-actions>
                                                      <v-spacer></v-spacer>
                                                      <v-btn color="blue darken-1" text @click="closeDelete">Annuller</v-btn>
                                                      <v-btn color="red darken-1" text @click="deleteItemConfirm">OK</v-btn>
                                                      <v-spacer></v-spacer>
                                                    </v-card-actions>
                                                  </v-card>
                                                </v-dialog>
                                            </v-toolbar>
                                        </template>
                                        <template v-slot:item.actions="{ item }">
                                            <v-icon
                                                small
                                                class="mr-2"
                                                @click="editItem(item)"
                                            >
                                                mdi-pencil
                                            </v-icon>
                                            <v-icon
                                                small
                                                @click="deleteItem(item)"
                                            >
                                                mdi-delete
                                            </v-icon>
                                        </template>
                                    </v-data-table>
                                    <v-snackbar
                                      v-model="snackbar"
                                      :multi-line="multiLine"
                                      :timeout="timeout"
                                      :color="snackcolor"
                                    >
                                      ${ snacktext }

                                      <template v-slot:action="{ attrs }">
                                        <v-btn
                                          color="white"
                                          text
                                          v-bind="attrs"
                                          @click="snackbar = false"
                                        >
                                          Fermer
                                        </v-btn>
                                      </template>
                                    </v-snackbar>
                                </v-col>
                            </v-row>
                        </v-tab-item>

                            <v-snackbar
                              v-model="snackbar"
                              :multi-line="multiLine"
                              :timeout="timeout"
                              :color="snackcolor"
                            >${ snacktext }

                              <template v-slot:action="{ attrs }">
                                <v-btn
                                  color="white"
                                  text
                                  v-bind="attrs"
                                  @click="snackbar = false"
                                >
                                  Fermer
                                </v-btn>
                              </template>
                            </v-snackbar>
                        </v-tabs-items>

                     {% block footer %}
                        {% include "partials/footer.html" %}
                     {% endblock footer %}
                    </v-container>
                </v-sheet>
            </v-main>
        </v-app>
{% endblock content %}

{% block extra_js %}
     <!-- incomes Plan vuejs -->
    <script src="{%  static 'js/pages/vue-treasury.js' %}"></script>
        <!--datatable js-->
    <script src="{%  static 'js/jquery-3.6.0.js' %}"></script>
    <script src="{%  static 'js/jquery.dataTables.js' %}"></script>
    <script src="{%  static 'js/dataTables.bootstrap5.js' %}"></script>
    <script src="{%  static 'js/dataTables.responsive.js' %}"></script>
    <script src="{%  static 'js/dataTables.buttons.js' %}"></script>
    <script src="{%  static 'js/buttons.print.js' %}"></script>
    <script src="{%  static 'js/buttons.html5.js' %}"></script>
    <script src="{%  static 'js/vfs_fonts.js' %}"></script>
    <script src="{%  static 'js/pdfmake.js' %}"></script>
    <script src="{%  static 'js/jszip.js' %}"></script>

    <script src="{% static 'js/pages/treasury.init.js' %}"></script>
    <script src="{% static 'js/pages/datatables.treasury.js' %}"></script>

{% endblock extra_js %}