const app=new Vue({el:"#app",delimiters:["${","}"],vuetify:new Vuetify,data(){return{comptes:[],classifications:["actif","passif"],operations:["encaissement","decaissement"],headers:[{text:"Numéro du compte",align:"start",sortable:!0,value:"number"},{text:"Intitulé du compte",value:"name"},{text:"Classification",value:"classification"},{text:"Opération",value:"operation"},{text:"Description",value:"description"},{text:"Actions",value:"actions",sortable:!1}],loading:!1,dialog:!1,dialogDelete:!1,snackbar:!1,multiLine:!1,snacktext:"",snackcolor:"",timeout:2e3,search:"",options:{},editedIndex:-1,editedItem:{id:"",number:"",name:"",classification:"",operation:"",description:""},defaultItem:{id:"",number:"",name:"",classification:"",operation:"",description:""}}},watch:{options:{handler(){this.getDataFromApi()},deep:!0},dialog(t){t||this.close()},dialogDelete(t){t||this.closeDelete()}},methods:{getDataFromApi(){this.loading=!0,this.apiCall("get","/api/accounting/plan/main/get").then(t=>{t=t.data;let e=[];Array.from(t).forEach(t=>{e.push({id:t.id,number:t.account_number,name:t.account_name,operation:t.account_type,classification:t.account_classification,description:t.account_description})}),this.comptes=e,this.loading=!1})},apiCall(t,e,i){return"get"===t?axios.get(e):"post"===t?axios.post(e,i):void 0},editItem(t){this.editedIndex=this.comptes.indexOf(t),this.editedItem=Object.assign({},t),this.dialog=!0},deleteItem(t){this.editedIndex=this.comptes.indexOf(t),this.editedItem=Object.assign({},t),this.dialogDelete=!0},deleteItemConfirm(){var t=this.editedItem.id,t=(this.loading=!0,{id:t});this.apiCall("post","/api/accounting/plan/main/delete",t).then(t=>{this.loading=!1,this.snacktext=t.data.message,this.snackbar=!0,this.snackcolor="green darken-3",this.comptes.splice(this.editedIndex,1),this.dialogDelete=!1})},close(){this.dialog=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},closeDelete(){this.dialogDelete=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},setData(){return{id:this.editedItem.id,account_number:this.editedItem.number,account_name:this.editedItem.name,account_classification:this.editedItem.classification,account_type:this.editedItem.operation,account_description:this.editedItem.description}},save(){var t;-1<this.editedIndex?(this.loading=!0,t=this.setData(),this.apiCall("post","/api/accounting/plan/main/update",t).then(t=>{t=t.data.message;this.snacktext=t,this.snackcolor="green darken-3",this.snackbar=!0,this.dialog=!1,this.loading=!1,Object.assign(this.comptes[this.editedIndex],this.editedItem),this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})}).catch(t=>{t=t.response.data.message;this.loading=!1,this.snacktext=t,this.snackbar=!0,this.snackcolor="red darken-3",this.dialog=!1})):(this.loading=!0,t=this.setData(),this.apiCall("post","/api/accounting/plan/main/save",t).then(t=>{t=t.data.message;this.snacktext=t,this.snackcolor="green darken-3",this.comptes.push(this.editedItem),this.dialog=!1,this.snackbar=!0,this.loading=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})}).catch(t=>{t=t.response.data.message;this.loading=!1,this.snacktext=t,this.snackbar=!0,this.snackcolor="red darken-3",this.dialog=!1}))}},computed:{formTitle(){return-1===this.editedIndex?"Nouveau Compte":"Modifier Compte"}},created(){this.getDataFromApi()}});